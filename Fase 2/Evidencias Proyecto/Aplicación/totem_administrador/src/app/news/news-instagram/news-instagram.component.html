<div class="container-fluid">
  <h2 class="text-primary text-center">
    Gestor de Noticias - Publicaciones de Instagram
  </h2>

  <!-- Botones de acción -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <button class="btn btn-info" (click)="goBack()">
      ← Volver al Gestor de Noticias
    </button>
    <button class="btn btn-primary" (click)="loadFirstPage()">
      Recargar Publicaciones
    </button>
  </div>

  <!-- Crear noticia automática -->
  <div class="mb-4">
    <h4 style="font-size: 1.5rem; font-family: 'Merriweather'">
      Crear Noticias Automáticas
    </h4>
    <div class="d-flex">
      <!-- Botón para crear noticia automática de imagen -->
      <button
        class="btn btn-success me-2"
        (click)="createAutomaticNews('image')"
      >
        Crear Noticia Automática de Imagen
      </button>
      <!-- Botón para crear noticia automática de video -->
      <button
        class="btn btn-success"
        (click)="createAutomaticNews('video')"
      >
        Crear Noticia Automática de Video
      </button>
    </div>
  </div>

  <!-- Paginación al Comienzo - Centrados -->
  <div class="pagination-controls text-center mb-4">
    <div
      class="pagination-buttons d-inline-flex align-items-center justify-content-center"
    >
      <button
        *ngIf="paging.before"
        (click)="loadPreviousPage()"
        class="btn btn-outline-secondary action-button mx-2"
      >
        Página Anterior
      </button>
      <span class="current-page mx-3">Página {{ currentPage }}</span>
      <button
        *ngIf="paging.after"
        (click)="loadNextPage()"
        class="btn btn-outline-secondary action-button mx-2"
      >
        Siguiente Página
      </button>
    </div>
  </div>

  <!-- Indicador de carga -->
  <div *ngIf="isLoading" class="d-flex justify-content-center mt-4">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>

  <!-- Lista de Publicaciones de Instagram en formato Grid -->
  <div *ngIf="!isLoading && posts.length > 0" class="news-grid">
    <div
      *ngFor="let post of posts; let i = index"
      class="news-item p-3 border rounded shadow-sm position-relative"
      [ngClass]="{
        'active-post': post.is_active === true
      }"
    >
      <!-- Indicador de que la publicación está activa -->
      <span
        *ngIf="post.is_active"
        class="badge badge-success position-absolute top-0 start-0 m-2"
      >
        Activa
      </span>

      <!-- Contenido de la publicación -->
      <h4 class="text-secondary mt-4">{{ post.caption }}</h4>
      <div class="media-container mt-3">
        <!-- Mostrar una imagen si el tipo de media es IMAGE -->
        <div *ngIf="post.media_type === 'IMAGE'">
          <img
            [src]="post.media_url"
            alt="{{ post.caption }}"
            class="img-fluid rounded shadow-sm"
          />
        </div>
        <!-- Mostrar un video si el tipo de media es VIDEO -->
        <div *ngIf="post.media_type === 'VIDEO'">
          <video
            [src]="post.media_url"
            controls
            class="mt-2 rounded shadow-sm"
          ></video>
        </div>
      </div>

      <div class="mt-3">
        <!-- Enlace a Instagram -->
        <a
          *ngIf="post.permalink"
          [href]="post.permalink"
          target="_blank"
          class="btn btn-link"
        >
          Ver en Instagram
        </a>

        <!-- Botón para agregar a noticias (deshabilitado si ya está activo) -->
        <button
          (click)="addPostToNews(post.id)"
          class="btn btn-primary mt-2"
          [disabled]="post.is_active"
        >
          {{ post.is_active ? "Noticia Agregada" : "Agregar a Noticias" }}
        </button>
      </div>
    </div>
  </div>

  <!-- Alertas de Confirmación - Colocadas arriba para mejor visibilidad -->
  <div
    *ngIf="successMessage"
    class="alert alert-success text-center alert-confirmation fixed-center"
  >
    ✔️ {{ successMessage }}
  </div>
  <div
    *ngIf="errorMessage"
    class="alert alert-danger text-center alert-confirmation fixed-center"
  >
    ⚠️ {{ errorMessage }}
  </div>

  <!-- Paginación al final del contenido - Centrados -->
  <div class="pagination-controls text-center mt-4">
    <div
      class="pagination-buttons d-inline-flex align-items-center justify-content-center"
    >
      <button
        *ngIf="paging.before"
        (click)="loadPreviousPage()"
        class="btn btn-outline-secondary action-button mx-2"
      >
        Página Anterior
      </button>
      <span class="current-page mx-3">Página {{ currentPage }}</span>
      <button
        *ngIf="paging.after"
        (click)="loadNextPage()"
        class="btn btn-outline-secondary action-button mx-2"
      >
        Siguiente Página
      </button>
    </div>
  </div>
</div>
